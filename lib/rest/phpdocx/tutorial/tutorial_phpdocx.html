<div id="breadcrumb"><a href="<?php echo bloginfo('url');?>" title="Home">Home</a> &gt; <a href="<?php echo bloginfo('url');?>/documentation" title="Home">Documentation</a> &gt; <strong>Tutorial</strong></div>
<div id="content_margen" style="width:840px;" class="tutorial">
<h2 class="ico_doc">PHPDocX v4.0 Tutorial</h2>
In this tutorial we are going to show you:
<ul>
  <li><a href="#installation">How to install PHPDocX</a></li>
  <li><a href="#creation">How to build a Word document from scratch using PHPDocX</a></li>
  <li><a href="#preparation">How to prepare a template for PHPDocX</a></li>
  <li><a href="#template">How to process a template with PHPDocX</a></li>
  <li><a href="#paragraph">Appendix: how to insert complex paragraphs into a Word document</a></li>
  <li><a href="#plugin">Appendix: how to use the PDF/DOC/RTF/HTML/ODT conversion plugin</a></li>
  <li><a href="#debug">Appendix: debugging options</a></li>
</ul>
<p style="font-style: italic; color: #444444; font-size: 11px">Since v3.0 PHPDocX is not fully backwards compatible with the older v2.7 version. if you prefer to stick to the older version you may still access the <a href="tutorial-v27" target="_blank">v2.7 tutorial</a>.</p>
<h3 id="installation">PHPDocX installation</h3>
<p>PHPDocX is very easy to install. Usually it is just enough to unzip the package   somewhere in your server and it is (almost) ready to go. </p>
<p>Obviously, as you could have guessed by its name, PHPDocX requires PHP 5 to   be installed in your server. Moreover the following PHP modules should be activated:</p>
<ul>
  <li>ZipArchive</li>
  <li>XSLT</li>	
  <li>Tidy (not strictly necessary but highly recommended)</li>
</ul>

<p>For your convenience we have included a PHP script in the package (directly   located in the app root folder), check.php, that will check if any of the requirements are missing.</p>
<p>Of course, <strong>DO NOT FORGET</strong> to include the license key for the PRO version:</p>
<ul>
  <li>Download the license key from the &quot;MyPHPDocX section&quot; of this website.</li>
  <li>Copy it (plain, with no other word or character) in code option in the config/phpdocxconfig.ini file.</li>
  <li>If you have got the <strong>Corporate version</strong> of the library you also need to include the domain name in the domain file that you may find also in the classes folder.</li>
</ul>
<div class="warning2">
<p><strong>WARNINGS:</strong> </p>
<ul>
  <li>The folder where your scripts are running and/or the folder where you want to store the resulting Word documents have to have writing permissions rights.
  </li>
  <li>If posible use always UTF-8 compatible editors to code your scripts or modify any script in the PHPDocX library. The final Word documents have to be UTF-8     encoded and nonUTF-8 characters may break the final document.</li>
  <li>All the content in a .docx file is stored in XML files so you should escape certain protected characters like the ampersand symbol (write &amp;amp; instead of &amp;).</li>
  <li>Make sure that your web server has activated the .docx MIME type in case you want your users to download directly the resulting Word documents to the browser (if not IE will believe that is a zip file).</li>
</ul>
</div>
<p>There is no a priori restrictions about the OS and server software as long   as it may run PHP 5. That includes, of course, basically all LINUX and UNIX   distributions as well as Windows and Mac OS. You may use Apache as web server   or lighttp, nginX, IIS, etcetera.</p>
<p>PHPDocX may use external data for your reports and documents coming from virtually   any data source and it is the responsability of the user to prepare it   so PHPDocX can represent it adequately. PHPDocX DOES NOT require MySQL or any   other specific Database software for its deployment and correct functioning.</p>
<p>You DO NOT need any copy of Microsoft Office Word to generate your Word documents.</p>
<p>PHPDocX PRO does also not need any kind of outbound connection to work    so it does not depend directly of a working Internet connection or any kind   of additional third party software.</p>
  <h3 id="creation">Creating a Word document from scratch</h3>
<p>Let&acute;s start with the standard &quot;hello world&quot; document.</p>
<p>The required script reads as follows:</p>
<pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);
$docx = new CreateDocx();
$docx-&gt;addText('Hello world!');
$docx-&gt;createDocx('../word_documents/hello_world');
</pre>
<p>The first line: require_once(path_to_phpdocx/classes/CreateDocx.inc) is a call   to the main class in PHPdocX, and path_to_phpdocx has to be sustituted by the   actual path to the library relative to the current script.</p>
<p>You can see here the final result and download the corresponding 	<a href="word_documents/hello_world.docx" title="sample PHPDOCX Word document" target="_blank">   Word document </a>:</p>
 <a href="img/hello_world.png" rel="lightbox[roadtrip]" > <img src="img/thumb_hello_world.png" /></a>
<p>OK, this has been simple enough but not very rewarding. Let's go one step further   and introduce a little more of formatting:</p>
  <pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);

$docx = new CreateDocx();
$text = array();
$text[] =
	array(
	'text' =&gt; 'I am going to write',
	);
$text[] =
	array(
	'text' =&gt; ' Hello World!',
	'b' =&gt; 'single',
	);

$text[] =
	array(
	'text' =&gt; ' using bold characters.',
	);
$docx-&gt;addText($text);
$docx-&gt;createDocx('../word_documents/hello_world_2');

</pre>

<p>Well now this start to look a little nicer although we have still some work   ahead (download the corresponding   <a href="word_documents/hello_world2.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
  <a href="img/hello_world2.png" rel="lightbox[roadtrip]" ><img src="img/thumb_hello_world2.png" /></a>
<p>At this point one may wonder if there is a simple way to &quot;wrap&quot; our   document in a more beautiful frame including, for example, headers and footers   and even a first page.</p>
<p>There are three ways to do so:</p>
<ul>
  <li>Importing the headers and footers from an existing Word document.</li>
  <li>Creating your own headers and footers via the addheader and addFooter methods.</li>
  <li>Using a different base template with all the required formatting.</li>
</ul>
<p>Like we have not yet talked about the &quot;base template&quot;, which turns to be an important and useful concept in the 2.5 version of the library and the addHeader and addFooter methods required of certain concepts not yet introduced, we   will restrict ourselves,by the time being (please, be patient), to the first   of the available solutions.</p>
<p>We have already prepared a standard Word document (.docx, of course) with a nice header and footer that we would like to insert in our current document.   Its relative path to this script is, for example, resources/niceHeaderAndFooter.docx.</p>
<p>So let's proceed:</p>
<pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);

$docx = new CreateDocx();

//Importing header and footer from external .docx file
$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
$text = array();
$text[] =
	array(
	'text' =&gt; 'I am going to write',
	);
$text[] =
	array(
	'text' =&gt; ' Hello World!',
	'b' =&gt; 'single',
	);

$text[] =
	array(
	'text' =&gt; ' using bold characters.',
	);
$docx-&gt;addText($text);

$docx-&gt;createDocx('../word_documents/hello_world_headersAndFooters');

</pre>
<p>This is definitely starting to look much nicer (download the corresponding   <a href="word_documents/hello_world_headersAndFooters.docx" title="sample PHPDOCX Word document" target="_blank"> Word document</a>):</p>
<a href="img/hello_world_headersAndFooters.png" rel="lightbox[roadtrip]" ><img src="img/thumb_hello_world_headersAndFooters.png" /></a>
<p>If you prefer only to import the header you may have used: <pre>$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx', 'header')</pre> and equivalently <pre>$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx', 'footer')</pre> if you only wish to import the footer.</p>
<p>The footers and headers can include photos, tables, standard text, lists, links, shapes,   etcetera. The import procedure also preserves the display properties of the headers and   footers (first, even and odd pages).</p>
<p>Now to continue we are going to populate our word document with a series of standard objects:</p>
<ul>
  <li>Lists</li>
  <li>Tables</li>
  <li>Images</li>

  <li>Charts</li>
</ul>
<p>There are many other posibilities but we prefer to refer to the documentation   for a complete set of examples in order not to clutter this tutorial with unneeded   details.</p>
<p>Let us first include a simple unordered nested list after our &quot;hello world&quot;   paragraph. In order to do so we should use the addList method:</p>
<pre>
//Call to PHPDocX
require_once(path_to_phpdocx/classes/CreateDocx.inc);

$docx = new CreateDocx();

//Importing header and footer from external .docx file
$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');

$text = array();
$text[] =
	array(
	'text' =&gt; 'I am going to write',
	);
$text[] =
	array(
	'text' =&gt; ' Hello World!',
	'b' =&gt; 'single',
	);
$text[] =
	array(
	'text' =&gt; ' using bold characters.',
	);
//We insert the the text into the Word document
$docx-&gt;addText($text);

//Let us now to add a nested unordered list
$myList = array('item 1',
                'item 2',
                array('subitem 2_1',
                      'subitem 2_2'),
                'item 3',
                array('subitem 3_1',
                      'subitem 3_2',
                      array('sub_subitem 3_2_1',
                            'sub_subitem 3_2_1')),
                'item 4');
								
$docx-&gt;addList($myList, array('val' =&gt; 1));

$docx-&gt;createDocx('../word_documents/hello_world_list');
</pre>
<p>What we get looks like this (download the corresponding <a href="word_documents/hello_world_list.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
  <a href="img/hello_world_list.png" rel="lightbox[roadtrip]" ><img src="img/thumb_hello_world_list.png" /></a>
<p>If you had choosen array('val' =&gt; 2) you would have got a standard numbered   list. Now you may wonder:</p>
<ul>
  <li>How can I get customized list styles?</li>
  <li>How can I insert something more than plain text as an item for a list?</li>
</ul>
<p>The answer to the first question is pretty simple: you may run the parseStyles()   method (<a href="examples/easy/parseStyles.php">see example</a>) in a separate script and generate a Word   document with all the info about the list, paragraph and table styles that are   available by default. We will see later that if you choose to use your own &quot;base   template&quot; you may incorporate all the styles you wish.</p>
<p>The answer to the second question is a little more elaborate but still simple   enough: you should use the rawWordML option and the createWordMLFragment to achieve more sophisticated formatting:</p>

<p>The corresponding code reads:</p>
<pre>
//Call to PHPDocX
require_once(path_to_phpdocx/classes/CreateDocx.inc);

$docx = new CreateDocx();

//Importing header and footer from external .docx file
$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');

$text = array();
$text[] =
	array(
	'text' =&gt; 'I am going to write',
	);
$text[] =
	array(
	'text' =&gt; ' Hello World!',
	'b' =&gt; 'single',
	);
$text[] =
	array(
	'text' =&gt; ' using bold characters.',
	);
//We insert the the text into the Word document
$docx-&gt;addText($text);

//We first prepare an item list element with more sophisticated formatting:
$newText = array(
	array(
		'text' =&gt; 'This is the text associated with the first item',
		'b' =&gt; 'single',
		'color' =&gt; 'b70000',
	),
	array(
		'text' =&gt; ' now without bold'
	),
	array(
		'text' =&gt; ' and blue',
		'color' =&gt; '0000b7'
	)
);

$formattedText = $docx->addText($newText, array('rawWordML' => true));

$myItem = $docx-&gt;createWordMLFragment(array($formattedText)));

//Let us now to add a nested unordered list
$myList = array($myItem,
                'item 2',
                array('subitem 2_1',
                      'subitem 2_2'),
                'item 3',
                array('subitem 3_1',
                      'subitem 3_2',
                      array('sub_subitem 3_2_1',
                            'sub_subitem 3_2_1')),
                'item 4');
								
$docx-&gt;addList($myList, array('val' =&gt; 1));

$docx-&gt;createDocx('../word_documents/hello_world_list2');

</pre>

<p>And you get (download the corresponding <a href="word_documents/hello_world_list2.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
    <a href="img/hello_world_list2.png" rel="lightbox[roadtrip]" ><img src="img/thumb_hello_world_list2.png" /></a>
<p>This way to insert elements one within the other may be extended to other cases in a simple way:</p>
<ul>
  <li>Set the rawWordML option to true.</li>
  <li>Create a WordML fragment via the createWordMlFragment method incorporating all the required content via an array.</li>
  <li>Insert the resulting WordML fragment: 
  	<ul>
  		<li>within a table,</li>
  		<li>within a list (only inline content),</li>
  		<li>anywhere in the Word document with the addRawWordML method, </li>
  		<li>or in the headers and footers via the addHeader and addFooter methods.</li>
  	</ul>
  </li>
</ul>

<p>Now we will try to insert a simple table so our Word document gets richer in   contents.</p>

<pre>
//Call to PHPDocX
require_once(path_to_phpdocx/classes/CreateDocx.inc);

$docx = new CreateDocx();

//Importing header and footer from external .docx file
$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');

$text = array();
$text[] =
	array(
	'text' =&gt; 'I am going to write',
	);
$text[] =
	array(
	'text' =&gt; ' Hello World!',
	'b' =&gt; 'single',
	);
$text[] =
	array(
	'text' =&gt; ' using bold characters.',
	);
//We insert the the text into the Word document
$docx-&gt;addText($text);

//We first prepare an item list element with more sophisticated formatting:
$newText = array(
	array(
		'text' =&gt; 'This is the text associated with the first item',
		'b' =&gt; 'single',
		'color' =&gt; 'b70000',
	),
	array(
		'text' =&gt; ' now without bold'
	),
	array(
		'text' =&gt; ' and blue',
		'color' =&gt; '0000b7'
	)
);

$formattedText = $docx->addText($newText, array('rawWordML' => true));

$myItem = $docx-&gt;createWordMLFragment(array($formattedText)));

//Let us now to add a nested unordered list
$myList = array($myItem,
                'item 2',
                array('subitem 2_1',
                      'subitem 2_2'),
                'item 3',
                array('subitem 3_1',
                      'subitem 3_2',
                      array('sub_subitem 3_2_1',
                            'sub_subitem 3_2_1')),
                'item 4');
								
$docx-&gt;addList($myList, array('val' =&gt; 1));

$valuesTable = array(
	array(
	'cell_1_1',
	'cell_1_2',
	'cell_1_3',
	'cell_1_4'
	),
	array(
	'cell_2_1',
	'cell_2_2',
	'cell_2_3',
	'cell_2_4'
	),
	array(
	'cell_3_1',
	'cell_3_2',
	'cell_3_3',
	'cell_3_4'
	)
);

$paramsTable = array(
	'border' =&gt; 'single',
	'border_sz' =&gt; 10
	);

$docx-&gt;addTable($valuesTable, $paramsTable);

$docx-&gt;createDocx('../word_documents/example_table');
</pre>

<p>And you get (download the corresponding <a href="word_documents/example_table.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
  <a href="img/example_table.png" rel="lightbox[roadtrip]" ><img src="img/thumb_example_table.png" /></a>
<p>This is certainly not the most beautiful table you have ever seen but we can   solve that problem pretty easily by having a look at the available table styles   in the document that we have generated before with the parseStyles() method.</p>
<p>For example we may use the &quot;MediumGrid3-accent5PHPDOCX&quot; accent table   style (blame Word for the funky names):</p>
   <pre>
//Call to PHPDocX
require_once(path_to_phpdocx/classes/CreateDocx.inc);

$docx = new CreateDocx();

//Importing header and footer from external .docx file
$docx -&gt;importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
$text = array();
$text[] =
	array(
	'text' =&gt; 'I am going to write',
	);
$text[] =
	array(
	'text' =&gt; ' Hello World!',
	'b' =&gt; 'single',
	);

$text[] =
	array(
	'text' =&gt; ' using bold characters.',
	);
$docx-&gt;addText($text);

//We first prepare an item list element with more sophisticated formatting:
$newText = array(
	array(
		'text' =&gt; 'This is the text associated with the first item',
		'b' =&gt; 'single',
		'color' =&gt; 'b70000',
	),
	array(
		'text' =&gt; ' now without bold'
	),
	array(
		'text' =&gt; ' and blue',
		'color' =&gt; '0000b7'
	)
);

$formattedText = $docx->addText($newText, array('rawWordML' => true));

$myItem = $docx-&gt;createWordMLFragment(array($formattedText)));

//Let us now to add a nested unordered list
$myList = array($myItem,
                'item 2',
                array('subitem 2_1',
                      'subitem 2_2'),
                'item 3',
                array('subitem 3_1',
                      'subitem 3_2',
                      array('sub_subitem 3_2_1',
                            'sub_subitem 3_2_1')),
                'item 4');
								
$docx-&gt;addList($myList, array('val' =&gt; 1));

$valuesTable = array(
	array(
	'cell_1_1',
	'cell_1_2',
	'cell_1_3',
	'cell_1_4'
	),
	array(
	'cell_2_1',
	'cell_2_2',
	'cell_2_3',
	'cell_2_4'
	),
	array(
	'cell_3_1',
	'cell_3_2',
	'cell_3_3',
	'cell_3_4'
	)
);

$paramsTable = array('TBLSTYLEval' =&gt; 'MediumGrid3-accent5PHPDOCX');

$docx-&gt;addTable($valuesTable, $paramsTable);

$docx-&gt;createDocx('../word_documents/example_table_style');
</pre>

<p>This certainly looks much nicer and pretty simple to implement (download the   corresponding <a href="word_documents/example_table_style.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
  <a href="img/example_table_style.png" rel="lightbox[roadtrip]" ><img src="img/thumb_example_table_style.png" /></a>
<p>But one always want something more and eventually one may need to insert tables   with &quot;rowspans&quot; and &quot;colspans&quot;. What can we do about that?</p>
<p>The simplest way to do it is to parse an HTML table and associate a Word style   to it.</p>
<p>Like our script is starting to get a little lengthly let us concentrate only   in the relevant part of it. Let's define a $myTable variable as follows:</p>
<pre>
$myHTML = '&lt;br /&gt;&lt;p style=&quot;font-family: Calibri; font-size: 11pt&quot;&gt;We include a table with rowspans and colspans using the embedHTML method.&lt;/p&gt;
&lt;table style=&quot;font-family: Calibri; font-size: 11pt&quot;&gt;
  &lt;tr&gt;
	  &lt;td&gt;header 1&lt;/td&gt;
	  &lt;td&gt;header 2&lt;/td&gt;
	  &lt;td&gt;header 3&lt;/td&gt;
	  &lt;td&gt;header 4&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
	  &lt;td rowspan=&quot;2&quot; colspan=&quot;2&quot;&gt;cell_1_1&lt;/td&gt;
	  &lt;td&gt;cell_1_3&lt;/td&gt;
	  &lt;td&gt;cell_1_4&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
	  &lt;td&gt;cell_2_3&lt;/td&gt;
	  &lt;td&gt;cell_2_4&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
	  &lt;td&gt;cell_3_1&lt;/td&gt;
	  &lt;td&gt;cell_3_2&lt;/td&gt;
	  &lt;td&gt;cell_3_3&lt;/td&gt;
	  &lt;td&gt;cell_3_4&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;';
 $docx-&gt;embedHTML($myHTML, array('tableStyle' =&gt; 'MediumGrid3-accent5PHPDOCX'));
</pre>
<p>This should render a table like this (download the corresponding <a href="word_documents/example_table_style_HTML.docx" title="hello_world_list2" target="_blank">   Word document</a>):</p>
  <a href="img/example_table_HTML.png" rel="lightbox[roadtrip]" ><img src="img/thumb_example_table_HTML.png" /></a>

<div class="warning2">
<p><strong>WARNINGS:</strong> </p>
<p> If you use px instead of pt as your CSS units take into account a 0.75 relative scale factor.</p>
</div>
<p>By the way, if you do not like the styles that come bundled with PHPDocX (basically   the quick styles that come with the standard Word 2007 distribution) you may   import custom styles from other Word document using the importStyles() method   or by using your own base template.</p>
<p>As you can foresee the embedHTML method may have multiple uses but for the   sake of brevity we will ignore them by the time being and we will move forward   to investigate how to include images and charts.</p>
<p>To insert an image is as simple as this:<br>
<pre>
$paramsImg = array(
'name' =&gt; '../img/image.png',//path to the image that we would like to insert
'scaling' =&gt; 90,//scaling factor, 100 corresponds to no scaling
'spacingTop' =&gt; 10,//top padding
'spacingBottom' =&gt; 10,//bottom padding
'spacingLeft' =&gt; 10,//left padding
'spacingRight' =&gt; 10,//right padding
'textWrap' =&gt; 1//corresponding to square format
);
$docx-&gt;addImage($paramsImg);
</pre>
<p>This should render an image like this (download the corresponding <a href="word_documents/example_image.docx" title="hello world phpdocx document" target="_blank">   Word document</a>):</p>
  <a href="img/example_image.png" rel="lightbox[roadtrip]" ><img src="img/thumb_example_image.png" /></a>
<p>If you need to include more than one photo with a precise layout you may combine the addTable method with createWordMLFragment to generate the desired ouput. For example:</p>

<pre class="brush: php; ">
$text = 'We are going to locate three pictures in a row just below this text. And we are going to use Trebuchet MS font to change a little bit :-)';

$paramsText = array(
	'font' => 'Trebuchet MS'
);

$docx->addText($text, $paramsText);

$images = array('aeg.png','aeg.png','aeg.png');
$wordImages = array();

foreach ($images as $image) {
	$paramsImg = array(
		'name' => $image,//The image to be inserted
		'dpi' => 120,//We force the images to a 100 dpi resolution
		'scaling' => 90,//We scale them at 90% size
		'spacingTop' => 10,//top padding
		'spacingBottom' => 10,//bottom padding
		'spacingLeft' => 10,//left padding
		'spacingRight' => 10,//right padding
		'textWrap' => 1,//corresponding to square format
		'rawWordML' => true//The result will be stored in a WordML fragment
	);
	$imageData = $docx->addImage($paramsImg);
	$imageFragment = $docx->createWordMLFragment($imageData);
	array_push($wordImages, $imageFragment);

}
$paramsTable = array(
	'TBLSTYLEval' => 'NormalTablePHPDOCX',
);
$valuesTable = array($wordImages);
$docx->addTable($valuesTable, $paramsTable);
</pre>

<p>This should now render the three inserted image like this(download the corresponding <a href="word_documents/example_image_table.docx" title="hello world phpdocx document" target="_blank">   Word document</a>):</p>
  <a href="img/example_image_table.png" rel="lightbox[roadtrip]" ><img src="img/thumb_example_image_table.png" /></a>
 
<p>To finish with the most basic functionality of PHPDocX we are going now to insert a chart.</p>
<p>PHPDocX virtually allows to include any chart that can be included through the standard Word interface:</p>
<ul>
  <li>2D and 3D pie charts,</li>
  <li>2D and 3D bar graphs,</li>
  <li>2D and 3D col bars,</li>
  <li>2D and 3D area charts,</li>
  <li>2D and 3D line charts,</li>
  <li>2D and 3D surface charts,</li>
  <li>2D and 3D bubble charts,</li>
  <li>radar charts,</li>
  <li>donought charts,</li>
  <li>scatter charts.</li>
</ul>
<p>As an example we will include a radar type chart:</p>
<pre>
$legends = array(
'legend' =&gt; array('sequence 1', 'sequence 2', 'sequence 3'),
'Category 1' =&gt; array(9.3, 2.4, 2),
'Category 2' =&gt; array(8.5, 4.4, 1),
'Category 3' =&gt; array(6.5, 1.8, 0.5),
'Category 4' =&gt; array(8.5, 3, 1),
'Category 5' =&gt; array(6, 5, 2.6),
);
$args = array(
'data' =&gt; $legends,
'type' =&gt; 'radar',
'style' =&gt; 'radar',
'title' =&gt; 'Radar chart',
'sizeX' =&gt; 15, 'sizeY' =&gt; 15,
'legendPos' =&gt; 't',
'border' =&gt; 1,
'vgrid' =&gt; 1
);
$docx-&gt;addChart($args);

</pre>
<p>And you get (download the corresponding <a href="word_documents/example_radar_chart.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
 <a href="img/example_radar_chart.png" rel="lightbox[roadtrip]" > <img src="img/thumb_example_radar_chart.png" /></a>
<p>In order to see all the available options you should visit the Full reference   Documentation, nevertheless to illustrate the flexibility of PHPDocX you may   chane very easily to a bar chart with the associated data data table just by setting the 'showtable' option to   1 and setting the type to &quot;colBar&quot;: </p>
<pre>
$legends = array(
'legend' =&gt; array('sequence 1', 'sequence 2', 'sequence 3'),
'Category 1' =&gt; array(9.3, 2.4, 2),
'Category 2' =&gt; array(8.5, 4.4, 1),
'Category 3' =&gt; array(6.5, 1.8, 0.5),
'Category 4' =&gt; array(8.5, 3, 1),
'Category 5' =&gt; array(6, 5, 2.6),
);
$args = array(
'data' =&gt; $legends,
'type' =&gt; 'colBar',
'title' =&gt; 'Chart with table',
'sizeX' =&gt; 15, 'sizeY' =&gt; 15,
'legendPos' =&gt; 't',
'border' =&gt; 1,
'vgrid' =&gt; 1,
'showtable' =&gt; 1
);
$docx-&gt;addChart($args);

</pre>
<p>So this time we will obtain (download the corresponding <a href="word_documents/example_chart_showtable.docx" title="sample PHPDOCX Word document" target="_blank">   Word document</a>):</p>
  <a href="img/example_chart_table.png" rel="lightbox[roadtrip]" > <img src="img/thumb_example_chart_table.png" /></a>
 
<h4>Using your own base template and setting up general config options</h4>
<p>We have already commented that PHPDocX users may use their own &quot;base templates&quot;   in order to generate their custom documents or reports.</p>
<p>The procedure is quite simple. One only has to make a call to the desired template   whenever a new docx is created:</p>
<pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);
$docx = new CreateDocx('../word_documents/numberedHeadings.docx');//You should include the path to your base template
$docx-&gt;addText('This is a numbered Heading', array('pStyle' =&gt; 'Heading1PHPDOCX'));
$docx-&gt;addText('Hello world again!');
$docx-&gt;addText('This is a  Subheading', array('pStyle' =&gt; 'Heading2PHPDOCX'));
$docx-&gt;addText('No more Hello world, please!');
$docx-&gt;createDocx('../word_documents/new_baseTemplate');
</pre>
<p>As you may see from the result(download the corresponding <a href="word_documents/new_baseTemplate.docx" title="hello world phpdocx document" target="_blank">   Word document</a>):</p>
  <a href="img/new_base_template.png" rel="lightbox[roadtrip]" ><img src="img/thumb_new_base_template.png" /></a>
<p>You may get customized headers and footers as well as many other configuration   options in just one shot. </p>
<p>For example you may also include a &quot;front page&quot; as structured content   that will be preserved by PHPDocX:</p>
<pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);
$docx = new CreateDocx('../word_documents/frontPageTemplate.docx');//You should include the path to your base template

$docx-&gt;addText('This is a numbered Heading', array('pStyle' =&gt; 'Heading1PHPDOCX'));
$docx-&gt;addText('Hello world again!');
$docx-&gt;addText('This is a  Subheading', array('pStyle' =&gt; 'Heading2PHPDOCX'));
$docx-&gt;addText('No more Hello world, please!');
$docx-&gt;createDocx('../word_documents/front_page');;
</pre>
<p>So we get (download the corresponding <a href="word_documents/front_page.docx" title="hello world phpdocx document" target="_blank">   Word document</a>):</p>
  <a href="img/front_page.png" rel="lightbox[roadtrip]" ><img src="img/thumb_front_page.png" /></a>
<p>Nevertheles to use the default template may show convenient because it has   been prepared to have available all the standard Word style options.</p>
<p>If you use your own template make sure, by using the parseStyles() method that   you have enough styles at your disposal.</p>

<div class="warning2">
<p><strong>WARNINGS:</strong> </p>
<p>The contents of your baseTemplate will be ignored (only headers,footers and   &quot;front page&quot;, if it has been inserted as stuctured content, will survive in the final document). If you   really want to work with an existing template for your document content you should use   the addTemplate() method on which we will ellaborate on next section.</p>
</div>

<p>Before going ahead with templates we would like to comment on the fact that   since PHPDocX v2.5 there is a configuration file: classes/PHPDOCXConfig.inc   where the following parameters can be globally set (although they can be override   by the corresponding methods for each particular document):</p>
<ul>
  <li>Base Template</li>
  <li>Default language</li>
  <li>Deafault paper size (A4, A3, letter or legal)</li>
</ul>
<h3 id="preparation"> How to prepare a template for PHPDocX</h3>
<p>It is quite often that rather than writing a full document from scratch we   just need to do certain modifications on an existing document:</p>
<ul>
  <li>Include a client&quot;s name</li>
  <li>Redraw a chart depending on new dynamical data</li>
  <li>Populate a table with certain dynamical data coming from a database, i.e.     items in an invoice</li>
  <li>Change certain images</li>
  <li>Etcetera</li>
</ul>
<p>For all those cases PHPDocX allows to use an existing Word document and do all   the required substitutions just by inserting the adequate placeholders variables.</p>
<p>For example, if we have a letter where the only &quot;variable&quot; part of   it is a name we could:</p>
<ul>
  <li>Replace the name by the variable: $NAME$</li>
  <li>Extract from a data source the actual name to be used in the resulting document and perform     the substitution via the addTemplateVariable() method.</li>
</ul>
<p>Let us carry out this process in greater detail.</p>
<p>First write, using your favourite Word editor, a very simple Word document   like this:</p>
<div class="subtheme_explication">
<p>Dear $NAME$,</p>
<p>I would like to say something interesting but unfortunately I do not have much   to say.</p>
<p>Best regards,</p>
<p style="font-weight: bold; color: #b70000">PHPDOCX Guru</p>
</div>

<div class="warning2">
<p><strong>WARNINGS:</strong> </p>
<p> Do not forget to save your document with the .docx extension and call   it, for example, myTestTemplate.docx.</p>
</div>

<p>For your convenience you may <a href="word_documents/myTestTemplate.docx" >download the document   here</a>.</p>
<p>The required PHPDocX script needed to carry away the replacement is as simple   as this:</p>
<pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);
$docx = new CreateDocx();
$docx-&gt;addTemplate('../word_documents/myTestTemplate.docx');
$docx-&gt;addTemplateVariable('NAME', 'John Smith');
$docx-&gt;createDocx('../word_documents/test_template');
?&gt;
</pre>

<p>And you will get as a result(download the corresponding 	<a href="word_documents/test_template.docx" title="hello world phpdocx document" target="_blank">   Word document</a>):</p>
  <a href="img/test_template.png" rel="lightbox[roadtrip]" ><img src="img/thumb_test_template.png" /></a>
<p>If you wish you may change the symbol used to enclosed the placeholder variable   to, for example '#' using the setTemplateSymbol('#') method. </p>

<div class="warning2">
<p><strong>WARNINGS:</strong> </p>
<p>The inclusion of placeholder variables is slightly different in the   case of images. In that case one should include the placeholder variable in   the alternative text associated with the image. This is done, for example in   the Word 2007 interface by clicking on the selected image with the right mouse   button, choosing the size menu entry and going to the &quot;alternative text&quot;   tab. </p>
</div>

<p>Since PHPDocX v2.5.1 we have a new method available, replaceTemplateVariableByHTML() that may be of great help. It basically simplifies the process to include new content from HTML into a Word document.</p>
<p>replaceTemplateVariableByHTML() basically extends the functionality of the embedHTML() in the case of templates. But everything may be more easily explained by a simple example.</p>
<p>Let us assume that you want to include some information coming from a <a href="http://www.2mdc.com/PHPDOCX/example.html" target="_blank">web page</a> into your <a href="word_documents/testHTML2mdc.docx" >Word document</a>. You may do so, preserving the format of the original HTML document in a very simple way:
<pre>
require_once(path_to_phpdocx/classes/CreateDocx.inc);
$docx-&gt;addTemplate('../word_documents/testHTML2mdc.docx');

$docx-&gt;replaceTemplateVariableByHTML('ADDRESS', 'inline', '&lt;p style=&quot;font-family: verdana; font-size: 11px&quot;&gt;C/ Matías Turrión 24, Madrid 28043 &lt;b&gt;Spain&lt;/b&gt;&lt;/p&gt;', array('isFile' =&gt; false, 'parseDivsAsPs' =&gt; true, 'downloadImages' =&gt; false));
$docx-&gt;replaceTemplateVariableByHTML('CHUNK_1', 'block', 'http://www.2mdc.com/PHPDOCX/example.html', array('isFile' =&gt; true, 'parseDivsAsPs' =&gt; true,  'filter' =&gt; '#capa_bg_bottom', 'downloadImages' =&gt; true));
$docx-&gt;replaceTemplateVariableByHTML('CHUNK_2', 'block', 'http://www.2mdc.com/PHPDOCX/example.html', array('isFile' =&gt; true, 'parseDivsAsPs' =&gt; false,  'filter' =&gt; '#lateral', 'downloadImages' =&gt; true));

$docx-&gt;createDocx('../docx/replaceTemplateVariableByHTML');	
</pre>
<p>And you will get as a result (download the corresponding <a href="word_documents/replaceTemplateVariableByHTML.docx" title="replaceTemplateVariableByHTML" target="_blank"> Word document</a>):</p>
<a href="img/webpage.png" rel="lightbox[roadtrip]" ><img src="img/thumb_webpage.png" /></a>
<p>The HTML content, as seen in the example, may come from a external HTML page or from a string. The filter parameter has been used to select different portions of the original HTML code and insert them in the Word document as desired. it does not only admits single id references one can introduce an array with different ids, classes and tags of his choice.</p>


<h3 id="template">How to process a template with PHPDocX</h3>
 
<p>Now we are going to show you an example that you may see at work in this very   same website: <a href="http://www.phpdocx.com/demo" target="_blank">http://www.phpdocx.com/demo</a>.</p>
<p>This demo requires three different templates that you may download, together   with the PHP script, from this <a href="http://www.phpdocx.com/wp-content/themes/lightword/files/phpdocx_demo.zip" target="_blank">zip file</a>   available online.</p>
<p>Like you can download all the required files and the resulting Word document from our <a href="http://www.phpdocx.com/demo" target="_blank">&quot;Demo Page&quot;</a> 	we will not include in the following nor screen capture neither the eesulting .docx files.
 
<p>Let us first have a look at the whole script:</p>

<pre>

require_once 'path to phpdocx';
$docx = new CreateDocx();
$dir = 'path to the folder with the templates';
$docx-&gt;addTemplate($dir. 'template_' . $_POST['template'] . '.docx');//We use the template chosen by the user

//Some variables included in the front page
$docx-&gt;addTemplateVariable('VAR_DATE', date(&quot;n/d/Y&quot;));
$docx-&gt;addTemplateVariable('VAR_NAME', $_POST['FullName']);
$docx-&gt;addTemplateVariable('VAR_TITLE', $_POST['Title']);


if(!empty($_POST['emptyData']) 
   $_POST['emptyData'] == 'true'){
   $docx-&gt;deleteTemplateBlock('chart');//If there is no data we eliminate the block that includes the chart
}else{
    $aData = array();
    foreach($_POST as $ind =&gt; $val){
        if(substr($ind, 0, strlen('DataName_')) == 'DataName_'){
            $aData[$val] = array($_POST['DataValue_' . substr($ind, strlen('DataName_'))]);
        }
    }
        $chart1 = array(
        'type' =&gt; 'pie3DChart',
        'showPercent' =&gt; 1,
        'sizeX' =&gt; 10,
        'sizeY' =&gt; 6,
        'js' =&gt; 'center'
    );
    if($_POST['template'] == 2){//Different templates have different charts
        $chart1['type'] = 'pieChart';
    }elseif($_POST['template'] == 3){
        $chart1 = array(
            'type' =&gt; 'colChart',
            'font' =&gt; 'Times New Roman',
            'sizeX' =&gt; 14,
            'sizeY' =&gt; 7,
            'border'=&gt; 'none',
            'jc' =&gt; 'center'
        );
        $chart1['type'] = 'colChart';
        $aData['legend'] = array('');            }

    $chart1['data'] = $aData;
    $docx-&gt;addTemplateChart('CHART_1', $chart1);
}

if(!empty($_POST['emptyList']) 
   $_POST['emptyList'] == 'true'){//If there is no data we eliminate the block containing the table
   $docx-&gt;deleteTemplateBlock('table');
}else{
   $aData = array();
    foreach($_POST as $ind =&gt; $val){
        if(substr($ind, 0, strlen('List_')) == 'List_'){
            $aData[] = array('VAR_ITEM' =&gt; $val, 'VAR_PRICE' =&gt; $_POST['AddressList_' . substr($ind, strlen('List_'))]);
        }
    }
    $docx-&gt;addTemplateVariable($aData, 'table', array('header' =&gt; false));
}
 if(empty($_POST['HTMLCode']) || $_POST['HTMLCode'] == '&lt;p&gt;Text with HTML format.&lt;/p&gt;')//If the user has not included any HTML text we eliminate the associated block
   $docx-&gt;deleteTemplateBlock('html');
else{
	  $code = stripslashes($_POST['HTMLCode']);
    $code = '&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;p{font-family: Arial;font-size:11pt;}li{font-family: Arial;font-size:11pt;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;' .  $code . '&lt;/body&gt;';
    $docx-&gt;addTemplateVariable('CHUNK_1',$code, 'html');
}
$docx-&gt;addTemplateImage('IMAGE_1' , $dir . 'image_'.$_POST['image'].'.jpg');
$docx-&gt;clearBlocks();//We clean any remaining block tags
$docx-&gt;createDocxAndDownload('/tmp/demo_template');//we send the resulting document to the browser

</pre>

<p>Let us analyse this script step by step.</p>

<p>The first chunk of code reads:</p>

<pre>$docx = new CreateDocx();
$dir = 'path to the folder with the templates';
$docx-&gt;addTemplate($dir. 'template_' . $_POST['template'] . '.docx');//We use the template chosen by the user</pre>

<p>We just create a new PHPDocX instance. Depending on the template choosen by the user in the corresponding webform we load into PHPDocX the coprresponding template with the addTemplate() method.</p>

<p>In the following block of code we start the actual parsing of the selected template:</p>

<pre>
//Some variables included in the front page
$docx-&gt;addTemplateVariable('VAR_DATE', date(&quot;n/d/Y&quot;));
$docx-&gt;addTemplateVariable('VAR_NAME', $_POST['FullName']);
$docx-&gt;addTemplateVariable('VAR_TITLE', $_POST['Title']);
</pre>

<p>This three lines of code do an standard &quot;variable by string&quot; substitution. The first of them all inserts the current date using the standard PHP date() method, while the last two substitute the VAR_NAME (in the header) and VAR_TITLE (front page) variables by the values introduced by the user in the corresponding web form.
</p>

<p>Now things start to get more sophisticated with:</p>

<pre>
if(!empty($_POST['emptyData']) 
   $_POST['emptyData'] == 'true'){
   $docx-&gt;deleteTemplateBlock('chart');//If there is no data we eliminate the block that includes the chart
}else{
    $aData = array();
    foreach($_POST as $ind =&gt; $val){
        if(substr($ind, 0, strlen('DataName_')) == 'DataName_'){
            $aData[$val] = array($_POST['DataValue_' . substr($ind, strlen('DataName_'))]);
        }
    }
        $chart1 = array(
        'type' =&gt; 'pie3DChart',
        'showPercent' =&gt; 1,
        'sizeX' =&gt; 10,
        'sizeY' =&gt; 6,
        'js' =&gt; 'center'
    );
    if($_POST['template'] == 2){//Different templates have different charts
        $chart1['type'] = 'pieChart';
    }elseif($_POST['template'] == 3){
        $chart1 = array(
            'type' =&gt; 'colChart',
            'font' =&gt; 'Times New Roman',
            'sizeX' =&gt; 14,
            'sizeY' =&gt; 7,
            'border'=&gt; 'none',
            'jc' =&gt; 'center'/*,
            'groupBar' =&gt; 'stacked'*/
        );
        $chart1['type'] = 'colChart';
        $aData['legend'] = array('');            }

    $chart1['data'] = $aData;
    $docx-&gt;addTemplateChart('CHART_1', $chart1);
}
</pre>
<p>The first &quot;if&quot; checks wether the user has introduced any data for the chart. If false we delete all the content between the two placeholder variables $BLOCK_chart$ with the deleteTemplateBlock() method (note that the prefix &quot;BLOCK_&quot; is omitted from the argument).</p>

<p>If there is data to represent graphically we prepare it, as usual, in an array with the standard options and use the addTemplateChart() method for the replacement. This example is a little more convoluted because the user may choose
between three different ways to represent his/her data.</p>

<p>The following chunk of code is particularly interesting because it allows us to populate a table with a custom number of rows depending on the user input:</p>

<pre>
if(!empty($_POST['emptyList']) 
   $_POST['emptyList'] == 'true'){//If there is no data we eliminate the block containing the table
   $docx-&gt;deleteTemplateBlock('table');
}else{
   $aData = array();
    foreach($_POST as $ind =&gt; $val){
        if(substr($ind, 0, strlen('List_')) == 'List_'){
            $aData[] = array('VAR_ITEM' =&gt; $val, 'VAR_PRICE' =&gt; $_POST['AddressList_' . substr($ind, strlen('List_'))]);
        }
    }
    $docx-&gt;addTemplateVariable($aData, 'table', array('header' =&gt; false));
}
</pre>

<p>Again we check if there is data to populate the table and in the contrary we remove the corresponding block of the document.
</p>

<p>if there is data, we include it in an array and insert it in the preformatted table with the addTemplateVariable() method that has been overloaded with two parameters: &quot;table&quot;, to instruct PHPDocX that we would like to create a new table row for each of the items of the $aData array, plus an option to indicate to PHPDocX that the table header is not to be repeated in every page when the table spreads through more than one page.</p>

<p>This block of code:</p>

<pre>
if(empty($_POST['HTMLCode']) || $_POST['HTMLCode'] == '&lt;p&gt;Text with HTML format.&lt;/p&gt;')//If the user has not included any HTML text we eliminate the associated block
   $docx-&gt;deleteTemplateBlock('html');
else{
	  $code = stripslashes($_POST['HTMLCode']);
    $code = '&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;p{font-family: Arial;font-size:11pt;}li{font-family: Arial;font-size:11pt;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;' .  $code . '&lt;/body&gt;';
    $docx-&gt;addTemplateVariable('CHUNK_1',$code, 'html');
}
</pre>
<p>checks if the user has included any text in the &quot;Rich Text Editor Box&quot; avalaible in the web form and if so includes it as HTML in the resulting Word document with the method: $docx->addTemplateVariable('CHUNK_1',$code, 'html').</p>

<p>Well, we are almost done. The end of the code replace an existing placeholder image with the image used by the user via the:

$docx->addTemplateImage('IMAGE_1' , $dir . 'image_'.$_POST['image'].'.jpg') method.</p>

<p>And we clean any reamining BLOCK tags with the clearBlocks() method before sending the final docx to the browser.</p>

<p>We hope that this tutorial has been of help and that you are now able to grasp all the potential uses that you may give to PHPDocX in your professional projects.</p>

<p><strong>Enjoy!!</strong></p>

<h3 id="paragraph">Appendix: how to insert complex paragraphs into a Word document</h3>
<p>Up to the v2.6 version of PHPDocX the management of complex paragraphs was delegated to templates. But since v2.6 one could use
the <strong>addPragraph</strong> method to insert into our Word document complex paragraphs with sophisticated formatting.</p> 
	
<p>But the method addParagraph has itself become obsolete since v3.1 (we are considering deprecating it for next releases) and we now recommend the new <strong>addText</strong> method because it is much faster and offers further functionality.

<p>Besides the standard styling (bold, italics, font family, font color, fornt size, margins, etcetera)
with the new addText method one may also include floating images and charts, links and bookmarks, footnotes and endnotes, line and column breaks, page numbers, current date and hour as well as arbitrary shapes.</p>
<p>To illustrate this method let us nalyse in detail the following chunk of code:</p>
<pre>
require_once('path_to_phpdocx/classes/CreateDocx.inc');

$docx = new CreateDocx();

$paragraphOptions= array('sz' => '11');

$text = array();

$text[]=array('color' => 'ff0000',
              'font' => 'Arial',
              'i' => 'single',
              'sz' => '11',
              'text' => 'This is a run of text written in Arial 11pt, red and italics to illustrate how easy is to apply formatting to a run of text. '
               );
               
$text[]=array('color' => '00ff00',
              'font' => 'Arial',
              'sz' => '12',
              'text' => 'This is a run of text written in Arial 12pt and green color so you may check how properties are inherited or not from the general paragraph options. '
               );
               
//Now include an image               
$paramsImg  = array('name' => '../files/img/logo_header.jpg',
                    'spacingLeft' => 20,
                    'spacingRight' => 0,
                    'spacingTop' => 10,
                    'spacingBottom' => 10,
                    'scaling' => 150,
                    'float' => 'right',
                    'textWrap' => 1,
                    'rawWordML' => true);              
$imageData = $docx->addImage($paramsImg);
$image = $docx->createWordMLFragment($imageData);

$text[] = $image;

$text[] =array('sz' => '11',
              'text' => 'This run of text is written in normal black text with the default document font (usually calibri). Since PHPDocX v2.6 we may insert in a simple manner paragraphs that include complex formatting, floating images, inline HTML content, links, bookmarks and even footnotes and endnotes in a very simple manner. '
               );
               
 //Now include a footnote   
 $footnoteData = $docx->addFootnote(array(
			'textDocument' => 'To include a footnote',
			'textFootnote' => 'You can also style the footnotes content, please, look in the API documentation.',
			'rawWordML' => true
		)
	);
$footnote = $docx->createWordMLFragment($footnoteData);  

$text[] = $footnote;    

$text[] = array('text' => ' in the middle of the paragraph is as simple as this. '); 

//And a link
$linkData = $docx->addLink('Link to phpdocx.com', array('url'=> 'http://www.phpdocx.com', 'color' => 'blue', 'u' => 'single', 'rawWordML' => true));
$link = $docx->createWordMLFragment($linkData);

$text[] = $link;

$text[] = array('text' => ' and some bookmarked data: ' );

//Add the bookmark
$bookmarkStart = $docx->addBookmark(array('type' => 'start', 'name' => 'bookmark_name', 'rawWordML' => true));
$bookmarkText = $docx->addText(' text that has been bookmarked.', array('rawWordML' => true));
$bookmarkEnd = $docx->addBookmark(array('type' => 'end', 'name' => 'bookmark_name', 'rawWordML' => true));
$bookmark = $docx->createWordMLFragment(array($bookmarkStart, $bookmarkText, $bookmarkEnd));

$text[] = $bookmark;

$text[] = array('text' => ' we are going to finish this long example with a line break', 'lineBreak' => 'after');
$text[] = array('text' => 'just here.');

$docx->addText($text, $paragraphOptions); 

//Another paragraph with a link to the previous bookmarked text

$text = array();

$text[] = array('text' => 'We may now link internally to the bookmark we have included in the last paragraph '
               );
//And a link to bookmark
$linkData = $docx->addLink('in this internal link', array('url'=> '#bookmark_name', 'color' => 'blue', 'u' => 'single', 'rawWordML' => true));
$link = $docx->createWordMLFragment($linkData);

$text[] = $link;
           
$text[] =array('text' => ' just by including a URL parameter as it is done usually with anchors.');

$docx->addText($text);


$docx->addText('We finish by adding a very simple plain text.');
         

$docx-&gt;createDocx('../docx/complex_paragraph');	
</pre>

<p>And we obtain the following docx document (download the corresponding <a href="word_documents/example_complex_paragraph.docx" title="sample PHPDOCX Word document: complex paragraph" target="_blank">   Word document</a>):</p>
<p> <a href="img/example_complex_paragraph.png" rel="lightbox[roadtrip]" > <img src="img/thumb_complex_paragraph.png" /></a></p>

<p>As you may see the <strong>addText</strong> method requires of two arguments:</p>
<ul>
	<li>The first one that we named &quot;$text&quot; includes all the info about the actual content included in the paragraph: text runs and specific formatting options. Notice that now the content of a run could be, besides ordinary text, an arbitrary WordML fragment offering us practically unlimited posibilities.</li>
	<li>The second one that was named by &quot;$paragraphOptions&quot; in the example includes all the general formatting options applied to tue whole paragraph.</li>
</ul>

<p>Although it has not been used in the example above it is also posible to include shapes in a similar manner. We will now use them to illustrate a different usage of the addText method.</p>
<p>Sometimes one may need to include a complex paragraph inside a table cell or as part of list of items, as we will see now the addtext method let us do so in quite a simple manner by setting to true the &quot;rawWordML&quot; option.</p>
<p>We are now going to write the PHPDocX code needed to generate a Word document that looks like this:
(download the corresponding 	<a href="word_documents/samples_color.docx" title="color samples" target="_blank">   Word document</a>):</p>
<p><a href="img/example_shapes.png" rel="lightbox[roadtrip]" ><img src="img/thumb_example_shapes.png" /></a></p>
<pre>
require_once 'path_to_phpdocx/CreateDocx.inc';

$docx = new CreateDocx();


$colors = array('red' =>'b70000',
                'grey' => '999999',
                'blue' => '2565ee',
                'green' => '25ee65');

$tableValues = array();

foreach($colors as $key => $value){
	$paragraphOptions = array('spacingTop' => 0, 'spacingBottom' => 0, 'rawWordML' => true);
	
	$text = array();
	$rect =  array('rawWordML' => true,
                'width' => 10,
                'height' => 10,
                'strokecolor' => '#555555',
                'strokeweight' => '1',
                'position' => 'relative',
                'margin-top' => '1.5',
                'fillcolor' => '#'.$value);
                
	$shapeData = $docx->addShape('rect', $rect);
	
	$shape = $docx->createWordMLFragment($shapeData);
	
	$text[] = $shape;
	
	$text[] = array('color' => '000000',
                  'font' => 'Arial',
                  'sz' => '11',
                  'text' => '          '
               );

	$text[] = array('color' => '000000',
                  'font' => 'Arial',
                  'sz' => '11',
                  'text' => 'This is the color of the following chunk of text: '
               );
	$text[] = array('color' => $value,
                  'font' => 'Arial',
                  'sz' => '11',
                  'text' => $key.' characters.'
               );
  $textData = $docx->addText($text, $paragraphOptions );
  $text = $docx->createWordMLFragment($textData);

  $tableRow = array($text);
  $tableValues[] = $tableRow;
}

$tableOptions = array('border' => 'none');
$docx->addTable($tableValues, $tableOptions);

	
$docx-&gt;createDocx('samples_color');
</pre>

<p>In this particular case we have chosen to insert the paragraph content inside a series of table cells. This example is artificially complicated but we have chosen to do it so to better illustrate the capabilities of the addText method and more generally the 'rawWordML' option. The generalization to the addList method is straightforward and we leave it as an exercise to the reader.</p>
<p>The different available shape options are described in the API documentation for the addShape method.</p>

<h3 id="plugin">Appendix: how to use the PDF/DOC/RTF/HTML/ODT conversion plugin</h3>
<p>Since v2.5 the PRO+ and CORPORATE versions of PHPDocX  include a plugin for advanced conversion to PDF, DOC, RTF, HTML and ODT formats.</p>
<p>This plugin is based on the conversion engine of Open Office so it transforms the resulting Word documents exactly as Open Office would do it.<p>
<p>This conversion has still some limitations,  Word charts are just ignored, but it produces <strong>very good results</strong> in the majority of cases.</p>
<div class="warning2">
<p><strong>WARNINGS:</strong></p>
<ul>
  <li>This plugin requires JRE 1.5 or higher to be installed in the web server, although it not requires any coding in Java.</li>
  <li>By the time being only works in LINUX servers (for a Windows compatible solution see below).</li>
  <li>The included version of OpenOffice is for 32bits Linux OS. To run it on 64bits servers just install the package ia32-libs available on every Linux distribution.</li>
  <li>There are a few methods in PHPDocX that are incompatible with the conversion plugin. We have introduced the enableCompatibilityMode method to inform the user of such incompatibilities.</li></ul></div>

<p>Its use is extremely simple:</p>



<pre>
require_once 'path_to_phpdocx/classes/CreateDocx.inc';

$docx = new CreateDocx();

$docx-&gt;enableCompatibilityMode();

$text = 'Lorem ipsum dolor sit amet, consectetur adipisicing elit, ' .
    'sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut ' .
    'enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut' .
    'aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit ' .
    'in voluptate velit esse cillum dolore eu fugiat nulla pariatur. ' .
    'Excepteur sint occaecat cupidatat non proident, sunt in culpa qui ' .
    'officia deserunt mollit anim id est laborum.';

$paramsText = array(
    'b' =&gt; 'single',
    'font' =&gt; 'Arial'
);

$docx-&gt;addText($text, $paramsText);

$docx-&gt;createDocx('example_text');
$docx-&gt;transformDocx('example_text.docx', 'example_text.pdf');

</pre>

<p>Basically one just needs to generate the Word document with PHPDocX as usual and call the transformDocX method with first argument the docx to be converted and as second argument the destination file with the desired extension.</p>
<div class="warning2">
<p><strong>WARNINGS:</strong></p>
<ul>
<li>If the plugin is not correctly initialized you may get an error. In that case you may: 
    <ul>
      <li>Run the following command: $ ../lib/openoffice/openoffice.org3/program/soffice -headless -accept="socket,host=127.0.0.1,port=8100;urp;" -nofirststartwizard') </li>
      <li>Or run OpenOffice as a service. In order to do that you may save this <a href="word_documents/OOService.sh" title="service script" target="_blank" style="color: blue">script</a> in your init.d files, set OpenOffice path in OOo_HOME var and start the service with: $ /etc/init.d/openoffice start, or using the service command. </li></ul></li></ul></div>
<p>Since v2.5.1 there is also available an interface with <strong>MS Word via COM</strong> that also allows for multiple format conversions.</p>

<p>We offer here a very simple example of use that is included in the example folder of the package:</p> 
<pre>
require_once 'path_to_phpdocx/classes/CreateDocx.inc';
$docx = new CreateDocx();
$pathToScript = dirname ( __FILE__ );
$pathArray = explode(&quot;\\&quot;, $pathToScript);
array_pop($pathArray);
$pathToFile = implode(&quot;\\&quot;, $pathArray).&quot;\\files\\&quot;;
$targetPath = implode(&quot;\\&quot;, $pathArray).&quot;\\docx\\&quot;;
$myPath = str_replace(&quot;\\&quot;, &quot;\\\\&quot;, $pathToFile);

$docx-&gt;transformDocxUsingMSWord($myPath.'TemplateText.docx', $targetPath.'test.pdf');
$docx-&gt;transformDocxUsingMSWord($myPath.'TemplateText.docx', $targetPath.'test.txt');
$docx-&gt;transformDocxUsingMSWord($myPath.'TemplateText.docx', $targetPath.'test.doc');
$docx-&gt;transformDocxUsingMSWord($myPath.'TemplateText.docx', $targetPath.'test.rtf');
$docx-&gt;transformDocxUsingMSWord($myPath.'TemplateText.docx', $targetPath.'test.html');
</pre>

<p>Of course, this requires to have a working instance of MS Word (2007 or newer) in the server.</p>

<h3 id="debug">Appendix: debugging options</h3>
<p>PHPDocX uses <strong>log4php</strong> as an external library for debugging.</p>
<p>The configuration options for <strong>log4php</strong> can be found in the <strong>config/log4php.xml</strong> file.</p>
<p>The default setup is:</p>
<pre>
    &lt;configuration xmlns="http://logging.apache.org/log4php/"&gt;
        &lt;appender name="default" class="LoggerAppenderConsole"&gt;
            &lt;layout class="LoggerLayoutPattern"&gt;
                &lt;param name="conversionPattern" value="%date %logger %-5level %msg%n" /&gt;
            &lt;/layout&gt;
        &lt;/appender&gt;
        &lt;root&gt;
            &lt;level value="warn" /&gt;
            &lt;appender_ref ref="default" /&gt;
        &lt;/root&gt;
    &lt;/configuration&gt;
</pre>
<p>So by default you only get warnings and higher logging levels.</p>
<p>If you would like to get on screen the maximum level of information provided by PHPDocX you shoud replace <strong>&quot;WARN&quot;</strong> by <strong>&quot;DEBUG&quot;</strong>;
<p> If you prefer to get the info not directly on screen but in a log file you should change the <strong>appender</strong> element as follows:</p>
<pre>
    &lt;configuration xmlns="http://logging.apache.org/log4php/"&gt;
        &lt;appender name="default" class="LoggerAppenderFile"&gt;
            &lt;layout class="LoggerLayoutPattern"&gt;
                &lt;param name="conversionPattern" value="%date %logger %-5level %msg%n" /&gt;
            &lt;/layout&gt;
            &lt;param name="file" value="phpdocx.log" /&gt;
            &lt;param name="append" value="true" /&gt;
        &lt;/appender&gt;
        &lt;root&gt;
            &lt;level value="trace" /&gt;
            &lt;appender_ref ref="default" /&gt;
        &lt;/root&gt;
    &lt;/configuration&gt;
</pre>
<p>&nbsp;</p>


</div>