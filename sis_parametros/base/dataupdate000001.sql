/********************************************I-DAUP-MMV-PARAM-0-23/02/2021********************************************/
update param.ttipo_cc set
id_tipo_cc_fk = 47
where id_tipo_cc in (1081, 1082, 1083);

update param.ttipo_cc set
id_tipo_cc_fk = 50
where id_tipo_cc in (1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157);

update param.ttipo_cc set
id_tipo_cc_fk = 43
where id_tipo_cc in (1036, 1044, 1045, 1046);

update param.tcentro_costo set
estado_reg = 'activo'
where id_centro_costo in (select e.id_centro_costo
                          from param.tcentro_costo e
                          where e.id_tipo_cc in ( select c.id_tipo_cc
                                                  from param.ttipo_cc c
                                                  where c.codigo in ( '40400001',
                                                                      '45120002',
                                                                      '12160000',
                                                                      '40980000',
                                                                      '12410000',
                                                                      '12420000',
                                                                      '12430000',
                                                                      '12510000',
                                                                      '12520000',
                                                                      '12600000',
                                                                      '12610000',
                                                                      '12620000',
                                                                      '12630000',
                                                                      '12640000',
                                                                      '12650000',
                                                                      '13520000')));
/********************************************F-DAUP-MMV-PARAM-0-23/02/2021********************************************/
/********************************************I-DAUP-EGS-PARAM-ETR-38910-06/05/2021********************************************/
-- UPDATE param.tproveedor SET
--     codigo = 'ODT101047'
-- WHERE id_proveedor = 40449;
UPDATE param.tproveedor SET
codigo = 'FUN101047'
WHERE id_proveedor = 40449;
/********************************************F-DAUP-EGS-PARAM-ETR-38910-06/05/2021********************************************/

/********************************************I-DAUP-YMR-PARAM-ETR-2138-07/06/2021********************************************/
WITH RECURSIVE subordinates AS (
	SELECT
		tcc.id_tipo_cc, 
        tcc.id_tipo_cc_fk, 
        tcc.codigo,
        tcc.movimiento,
        tcc.fecha_final
	FROM
		param.ttipo_cc tcc
	WHERE 
    	tcc.id_tipo_cc = 41
	UNION
		SELECT
			e.id_tipo_cc, 
            e.id_tipo_cc_fk, 
            e.codigo,
            e.movimiento,
            e.fecha_final
		FROM
			param.ttipo_cc e
		INNER JOIN subordinates s ON s.id_tipo_cc = e.id_tipo_cc_fk
) UPDATE param.ttipo_cc ttc
	 SET fecha_final = TO_DATE('20201231', 'YYYYMMDD')
    FROM subordinates
   where subordinates.id_tipo_cc = ttc.id_tipo_cc
     and subordinates.movimiento = 'si'
     and subordinates.codigo not in ('200884', '200900', '200966', '200968', '200969', '200971', '200972', '200973', '200976', '200977', '200978', '200979', '200980', '200985', 
'200986', '200988', '200989', '200990', '201000', '40110111', '40110112', '40110114', '40110115', '40110116', '40110117', '40110118', '40110119', 
'40110120', '40110121', '40120002', '40120003', '40120004', '40120005', '40120006', '40120007', '40130345', '40130378', '40130380', '40130401', 
'40130406', '40130407', '40130408', '40130409', '40130410', '40210003', '40210004', '40210005', '40210007', '40210008', '40210009', '40210010', 
'40210011', '40210012', '40210013', '40210014', '40210016', '40210017', '40210018', '40220001', '40220002', '40230001', '40230016', '40230030', 
'40230037', '40240002', '40240003', '40240004', '40250002', '40250003', '40250005', '40310019', '40510012', '40510015', '40510042', '40510044', 
'40510046', '40510047', '40520042', '40600001', '40710000', '40710001', '40710002', '40710010', '40710011', '40710012', '40710013', '40710020', 
'40710021', '40710040', '40710041', '40710050', '40710061', '40710062', '40710100', '40720000', '40720001', '40720002', '40720003', '40720004', 
'40720010', '40720011', '40720012', '40720013', '40720014', '40720020', '40720021', '40720041', '40720042', '40720050', '40720061', '40720062', 
'40720090', '40720100', '40730021', '40740002', '40740010', '40740011', '40740020', '40740021', '40740040', '40740061', '40740062', '40740100', 
'40750000', '40750001', '40750010', '40750011', '40750012', '40750020', '40750021', '40750040', '40750051', '40750061', '40750062', '40750100', 
'40760000', '40760010', '40760020', '40760021', '40760041', '40760100', '40770000', '40770001', '40770010', '40770011', '40770020', '40770021', 
'40770041', '40770050', '40770061', '40770062', '40770100', '40780000', '40780001', '40780010', '40780011', '40780020', '40780021', '40780040', 
'40780051', '40780061', '40780062', '40780100', '40790000', '40790001', '40790002', '40790003', '40790010', '40790011', '40790012', '40790013', 
'40790020', '40790021', '40790041', '40790051', '40790060', '40790061', '40790064', '40790065', '40790100', '40800001', '45110027', '45110034', 
'45110035', '45110036', '45110037', '45110038', '45110039', '45110040', '45110041', '45110042', '45130137', '45130139', '45130148', '45130149', 
'45130151', '45130152', '45130153', '45210002', '45220001', '45220002', '45510015', '45510020', '45510021', '45510022', '45510023', '45510024', '45510025');
/********************************************F-DAUP-YMR-PARAM-ETR-2138-07/06/2021********************************************/
